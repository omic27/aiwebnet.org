# Архитектура проекта (чтобы код не ломался)

## 1) Слои (обязательно соблюдать)
1) Telegram Layer
- обработчики команд и callback-кнопок
- FSM/состояния пользователя
- сбор ввода и отправка ответа
- НИКАКОЙ бизнес-логики анализа матчей

2) Analytics Core
- логика отбора матчей
- красные флаги
- классификация матча
- фильтры рынков (anti-BTTS, anti-1X2, поведение фаворита)
- формирование структуры ответа (не отправка, а именно "данные ответа")

3) Data Layer
- получение матчей/статистики/коэффициентов (если есть)
- адаптеры источников
- нормализация данных
- кэш/хранилище

4) Infrastructure
- config/.env
- логирование
- ошибки/исключения
- тесты/линтеры

## 2) Правила изменений (для Codex и разработчиков)
- Не менять архитектуру без прямого запроса.
- Не переименовывать файлы/папки без необходимости.
- Любая фича — отдельной веткой и отдельным PR.
- Если не уверен, добавляй новый модуль, не переписывай существующий.
- Бот должен отвечать пользователю ВСЕГДА (даже при ошибках данных): "SKIP/недостаточно данных/ошибка источника".

## 3) Интерфейсы
Рекомендуемая форма контрактов (не обязательно реализовано сейчас, но это ориентир):
- `analyze_match(input) -> AnalysisResult`
- `AnalysisResult.decision in {TAKE, SKIP}`
- `AnalysisResult.recommended_markets: list`
- `AnalysisResult.risks: list`
- `AnalysisResult.confidence in {A,B,C}`

Telegram слой должен работать только с `AnalysisResult` и не знать внутренние детали модели.
